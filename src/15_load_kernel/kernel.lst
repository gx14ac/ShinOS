     1                                  %include "../include/define.asm"
     1                              <1> BOOT_LOAD        equ 0x7C00                    ; Start Boot Program position
     2                              <1> BOOT_SIZE        equ (1024 * 8)                ; Boot Code Size
     3                              <1> SECT_SIZE        equ (512)                     ; Sector Size
     4                              <1> BOOT_SECT        equ (BOOT_SIZE / SECT_SIZE)   ; Boot Program to Sector Count
     5                              <1> E820_RECORD_SIZE equ 20                        ; Memory Size
     6                              <1> KERNEL_LOAD      equ 0x0010_1000               ; Kernel load addr
     7                              <1> KERNEL_SIZE      equ (1024 * 8)                ; Kernel size
     8                              <1> BOOT_END         equ (BOOT_LOAD + BOOT_SIZE)
     9                              <1> BOOT_SECT        equ (BOOT_SIZE / SECT_SIZE)
    10                              <1> KERNEL_SECT      equ (KERNEL_SIZE / SECT_SIZE)
     2                                  %include "../include/macro.asm"
     1                              <1> %macro cdecl 1-*.nolist
     2                              <1> 
     3                              <1>     %rep %0 - 1
     4                              <1>         push %{-1:-1}
     5                              <1>         %rotate -1
     6                              <1>     %endrep
     7                              <1>     %rotate -1
     8                              <1> 
     9                              <1>         call %1
    10                              <1> 
    11                              <1>     %if 1 < %0
    12                              <1>         add sp, (__BITS__ >> 3) * (%0-1)
    13                              <1>     %endif
    14                              <1> 
    15                              <1> %endmacro
    16                              <1> 
    17                              <1> struc drive
    18 00000000 <res 00000002>      <1>         .no   resw  1               ; Drive Number.
    19 00000002 <res 00000002>      <1>         .cyln resw  1               ; Cylinder.
    20 00000004 <res 00000002>      <1>         .head resw  1               ; Head.
    21 00000006 <res 00000002>      <1>         .sect resw  1               ; Sector.
    22                              <1> endstruc
     3                                  
     4                                      ORG KERNEL_LOAD              ; kernel load address
     5                                  
     6                                  ;Instruct the assembler to 32bit
     7                                  [BITS 32]
     8                                  ;****************************
     9                                  ; Entry Point
    10                                  ;****************************
    11                                  kernel:
    12 00000000 EBFE                        jmp $
    13                                  
    14                                  ;****************************
    15                                  ; Padding
    16                                  ;****************************
    17 00000002 00<rept>                times KERNEL_SIZE - ($ - $$) db 0
